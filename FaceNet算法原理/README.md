ResNet (谷歌人脸识别系统)
====  
#
* 参考文献为Florian Schroff的 [FaceNet: A Unified Embedding for Face Recognition and Clustering](https://arxiv.org/abs/1503.03832) 

#
简介：
-------
* 近年来，人脸识别技术取得了飞速的进展，但是人脸验证和识别在自然条件中应用仍然存在困难。本文中，作者开发了一个新的人脸识别系统：FaceNet，可以直接将人脸图像映射到欧几里得空间，空间距离的长度代表了人脸图像的相似性。只要该映射空间生成，人脸识别，验证和聚类等任务就可以轻松完成。文章的方法是基于深度卷积神经网络。FaceNet在LFW数据集上，准确率为0.9963，在YouTube Faces DB数据集上，准确率为0.9512。
* FaceNet是一个通用的系统，可以用于人脸验证（是否是同一人？），识别（这个人是谁？）和聚类（寻找类似的人？）。FaceNet采用的方法是通过卷积神经网络学习将图像映射到欧几里得空间。空间距离直接和图片相似度相关：同一个人的不同图像在空间距离很小，不同人的图像在空间中有较大的距离。只要该映射确定下来，相关的人脸识别任务就变得很简单。
* 当前存在的基于深度神经网络的人脸识别模型使用了分类层（classification layer）：中间层为人脸图像的向量映射，然后以分类层作为输出层。这类方法的弊端是不直接和效率低。
* 与当前方法不同，FaceNet直接使用基于triplets的LMNN（最大边界近邻分类）的loss函数训练神经网络，网络直接输出为128维度的向量空间。我们选取的triplets（三联子）包含两个匹配脸部缩略图和一个非匹配的脸部缩略图，loss函数目标是通过距离边界区分正负类，如图所示:<br>
![](https://pic2.zhimg.com/80/v2-ced157b8ca1fa96603c30b651eb2e1e0_hd.jpg)

#
方法概述：
-------
上图步骤可以描述为：

* 前面部分采用一个CNN结构提取特征，
* CNN之后接一个特征归一化（使其特征的||f(x)||2=1,这样子，所有图像的特征都会被映射到一个超球面上)，
* 再接入一个embedding层(嵌入函数)，嵌入过程可以表达为一个函数，即把图像x通过函数f映射到d维欧式空间。
* 此外，作者对嵌入函数f(x)的值，即值阈，做了限制。使得x的映射f(x)在一个超球面上。
* 接着，再去优化这些特征，而文章这里提出了一个新的损失函数，triplet损失函数(优化函数），而这也是文章最大的特点所在。

#
Triplet Loss(三元组损失函数)
-------
* 什么是Triplet Loss呢？故名思意，也就是有三张图片输入的Loss（之前的都是Double Loss或者是SingleLoss）。本文通过LDA思想训练分类模型，使得类内特征间隔小，类间特征间隔大。为了保证目标图像 与类内图片(正样本)特征距离小，与类间图片(负样本)特征距离大。需要Triplet损失函数来实现。<br>
![](https://pic2.zhimg.com/80/v2-e97dea2c74c31b53803925294983b7c8_hd.jpg)
* 根据上文，可以构建一个约束条件：<br>
![](https://pic2.zhimg.com/80/v2-fb0de06aa80bfd4bb6eb9a24f9855c6b_hd.jpg)
![](https://pic3.zhimg.com/80/v2-89f6cb30446edc2f7748ed0541d1aeba_hd.jpg)

> 其中，alpha为positive/negtive的边界, (1)表示：左边类内的距离（加上边际）要小于右边类间的距离，这个约束需要在所有的三元组上都成立。

